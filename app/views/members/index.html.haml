%h1 Listing members

#member-list
  .table-responsive
    %table.table.table-striped
      %tr
        %th Name
        %th Phone(s)
        %th Email
        - if can? :view, @members
          %th Role(s)
        - if can? :manage, @members
          %th

      - @members.each do |member|
        %tr
          %td.name= member.fullname
          %td.phone
            - member.phones.by_type.each do |phone|
              = phone.listing
              %br
          %td.email= mail_to member.email

          - if can? :view, @members
            %td= member.roles.by_name.map{|r| r.name}.join(', ')

          - if can? :manage, @members
            %td
              .btn-group.btn-group-sm
                = button_tag class: [ 'btn', 'btn-small' ] do
                  = link_to member do
                    %span.glyphicon.glyphicon-search
                = button_tag class: [ 'btn', 'btn-small' ] do
                  = link_to edit_member_path(member) do
                    %span.glyphicon.glyphicon-pencil
                = button_tag class: [ 'btn', 'btn-small' ] do
                  = link_to member, :method => :delete, data: { confirm: 'Are you sure?' } do
                    %span.glyphicon.glyphicon-trash

  = will_paginate @members
  %br

  -if current_member.is_admin?
    = link_to 'New Member', new_member_path
